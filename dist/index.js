"use strict";var v=require("path"),g=require("fs"),S=require("module"),o=require("@esbuild-kit/core-utils"),i=require("get-tsconfig");function l(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var u=l(v),y=l(g),f=l(S);const T=/^\.{0,2}\//,N=/\.[cm]?tsx?$/,F=`${u.default.sep}node_modules${u.default.sep}`,a=process.env.ESBK_TSCONFIG_PATH?{path:process.env.ESBK_TSCONFIG_PATH,config:i.parseTsconfig(process.env.ESBK_TSCONFIG_PATH)}:i.getTsconfig(),P=a==null?void 0:a.config,p=a&&i.createPathsMatcher(a),m=o.installSourceMapSupport(),M=o.compareNodeVersion([13,2,0])>=0||o.compareNodeVersion([12,20,0])>=0&&o.compareNodeVersion([13,0,0])<0;function _(e,s){process.send&&process.send({type:"dependency",path:s});let t=y.default.readFileSync(s,"utf8");if(s.endsWith(".cjs")&&M){const r=o.transformDynamicImport(t);r&&(t=o.applySourceMap(r,s,m))}else{const r=o.transformSync(t,s,{tsconfigRaw:P});t=o.applySourceMap(r,s,m)}e._compile(t,s)}const h=f.default._extensions;[".js",".ts",".tsx",".jsx"].forEach(e=>{h[e]=_}),Object.defineProperty(h,".mjs",{value:_,enumerable:!1});const O=o.compareNodeVersion([16,0,0])>=0||o.compareNodeVersion([14,18,0])>=0,d=f.default._resolveFilename;f.default._resolveFilename=function(e,s,t,r){if(!O&&e.startsWith("node:")&&(e=e.slice(5)),p&&!T.test(e)&&!(s!=null&&s.filename.includes(F))){const c=p(e);for(const n of c)try{return d.call(this,n,s,t,r)}catch{}}if(s&&N.test(s.filename)){const c=o.resolveTsPath(e);if(c)try{return d.call(this,c,s,t,r)}catch(n){if(n.code!=="MODULE_NOT_FOUND")throw n}}return d.call(this,e,s,t,r)};
